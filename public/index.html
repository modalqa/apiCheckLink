<!DOCTYPE html>
<html>
<head>
  <title>Link Checker | QA Modern</title>
  <!-- Tambahkan Favicon -->
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  
  <!-- Tambahkan Bootstrap CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1 class="mt-5 mb-3">Link Checker</h1>

    <!-- Form untuk memasukkan URL -->
    <form action="/check-links" method="post">
      <div class="form-group">
        <label for="url">URL to Check:</label>
        <input type="text" class="form-control" id="url" name="url" required>
      </div>
      <div class="btn-group">
        <button type="submit" class="btn btn-primary">Check Links</button>
        <button id="download-csv" class="btn btn-primary" disabled>Download Result</button>
      </div>
    </form>

    <!-- Element loading -->
    <div id="loading" class="mt-4" style="display: none;">
      <p>Loading...</p>
    </div>

    <!-- Hasil pemeriksaan tautan -->
    <div class="mt-4">
      <h3>Results</h3>
      <p>URL: <span id="result-url"></span></p>
      <p>Total Links: <span id="result-link-count"></span></p>
      <p>Broken Links: <span id="result-broken-count"></span></p>
      <p>Green Links: <span id="result-green-count"></span></p>
    </div>
    <blockquote>
      <h4>The reason I created this tool</h4>
      <p>
        I created this tool because as a QA Engineer, I often get reports that the links shared by the retention team are broken. After I checked it, it turned out that the link was broken for some reason. This incident made me think about creating this tool, especially when I have to check more than 10 links, because broken links have a very negative impact on business.
      </p>
    </blockquote>

    <!-- Coming Soon -->
    <div class="coming">
      <p>I want to create more powerful features than the current version, coming soon</p>
    </div>
    
    <div class="feature">
      <div class="icon">Icon</div>
      <div class="description">
        <h4>Multiple Check</h4>
        <p>Multi Check allows you to run Broken Link Checker for multiple websites at once. The report is then emailed to you automatically.</p>
      </div>
    </div>
    
    <div class="feature">
      <div class="icon">Icon</div>
      <div class="description">
        <h4>Auto Check</h4>
        <p>Auto Check, namely running Broken Link Checker through your website periodically and sending reports via email automatically.</p>
      </div>
    </div>  
    <!-- Tambahkan tautan ke Saweria.co/qamodern -->
    <footer>
<!--       <p>Support the QA Engineer: <a href="https://saweria.co/qamodern" target="_blank">Donate on Saweria</a></p> -->
      <p>Contact QA Engineer: <a href="mailto:depfaris@gmail.com">depfaris@gmail.com</a></p>
      
    </footer>
  </div>

  <!-- Tambahkan Bootstrap JavaScript dan jQuery -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="one-script.js"></script>

  <!-- <script>
    $(document).ready(function () {
      $('form').submit(function (event) {
        event.preventDefault();

        const url = $('#url').val();

        $.post('/check-links', { url }, function (data) {
          $('#result-url').text(data.url);
          $('#result-link-count').text(data.linkCount);
          $('#result-broken-count').text(data.brokenCount);
          $('#result-green-count').text(data.greenCount);

          // Hapus atribut 'disabled' dari tombol "Download Result" untuk mengaktifkannya
          $('#download-csv').removeAttr('disabled');
        });
      });

      // Menangani klik tombol unduh
      $('#download-csv').click(function () {
        const url = $('#url').val();
        $.post('/check-links', { url }, function (data) {
          const checkedLinks = data.linkStatuses; // Ambil daftar tautan dari respons server

          // Buat data CSV
          let csvContent = "URL,Status\n";
          checkedLinks.forEach(function (link) {
            csvContent += `"${link.link}","${link.status}"\n`;
          });

          // Buat objek Blob untuk file CSV
          const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });

          // Buat nama file dinamis dengan tanggal dan waktu
          const now = new Date();
          const formattedDate = now.toLocaleDateString().replace(/\//g, '-');
          const formattedTime = now.toLocaleTimeString().replace(/:/g, '-');
          const fileName = `checked_links_${formattedDate}_${formattedTime}.csv`;

          // Buat tautan unduhan
          const link = document.createElement("a");
          link.href = URL.createObjectURL(blob);
          link.download = fileName;

          // Klik tautan unduhan secara otomatis
          link.click();
        });
      });
    });
  </script> -->
</body>
</html>